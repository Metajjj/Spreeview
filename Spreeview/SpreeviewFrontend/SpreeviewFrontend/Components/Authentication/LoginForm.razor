@using System.ComponentModel.DataAnnotations
@using RecordShop.Frontend.Client.Identity.Models
<EditForm Model="_input" method="post" OnValidSubmit="Submit"
          FormName="login" Context="editform_context">
    <DataAnnotationsValidator />
    <h2>Use a local account to log in.</h2>
    <hr />
    <div class="form-floating mb-3">
        <InputText @bind-Value="_input.Email"
                   id="Input.Email"
                   class="form-control"
                   autocomplete="username"
                   aria-required="true"
                   placeholder="name@example.com" />
        <label for="Input.Email" class="form-label">
            Email
        </label>
        <ValidationMessage For="() => _input.Email"
                           class="text-danger" />
    </div>
    <div class="form-floating mb-3">
        <InputText type="password"
                   @bind-Value="_input.Password"
                   id="Input.Password"
                   class="form-control"
                   autocomplete="current-password"
                   aria-required="true"
                   placeholder="password" />
        <label for="Input.Password" class="form-label">
            Password
        </label>
        <ValidationMessage For="() => _input.Password"
                           class="text-danger" />
    </div>
    <div>
        <button type="submit" class="w-100 btn btn-lg btn-primary">
            Log in
        </button>
    </div>
    <div class="mt-3">
        <p>
            <a href="register">Register as a new user</a>
        </p>
    </div>
</EditForm>

@code
{
    [SupplyParameterFromForm]
    private LoginFormModel _input { get; set; } = new();
    
    [Parameter]
    public EventCallback<LoginFormModel> OnSubmit { get; set; }
    
    private async Task Submit()
    {
        await OnSubmit.InvokeAsync(_input);
    }
}
