@using CommonLibrary.DataClasses.ReviewModel
@using SpreeviewFrontend.Components
@using SpreeviewFrontend.Services
@using SpreeviewFrontend.Components.Header
@using SpreeviewFrontend.Components.Footer
@using SpreeviewFrontend.Services.ApiReview
@inherits LayoutComponentBase
@inject IUserPreferencesService UserPreferencesService
@inject IApiReviewService ReviewService

@code {
	private UserPreferences _preferences = new();

	public RefreshReviewsClass RefreshReviews { get; set; } = new() { Refresh = false };

	protected override async Task OnInitializedAsync()
	{
		_preferences = await UserPreferencesService.GetUserPreferencesAsync();
		RefreshReviews.OnRefreshChanged += () => StateHasChanged();
	}

	public void Dispose()
	{
		RefreshReviews.OnRefreshChanged -= () => StateHasChanged();
	}
}

@* Example of dynamically setting html attributes via UserPreferences *@
<div class="@(_preferences.Theme == Theme.Dark ? "dark" : "light") flex h-screen flex-col justify-between">
	<Header />
	<main>
		<CascadingValue Value="@RefreshReviews" IsFixed="false">
			@Body
		</CascadingValue>
	</main>
	<Footer />
</div>
